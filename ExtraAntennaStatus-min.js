javascript:let mode="";function getXMLDocument(data){try{const parser=new DOMParser();const doc=parser.parseFromString(data,"application/xml");const errorNode=doc.querySelector("parsererror");if(errorNode){console.log("XML Error: Error while parsing XML document");return null;}return doc;}catch(err){console.log("XML Error:",err.message);}return null;}function extractXML(tag,document){try{const tags=document.getElementsByTagName(tag);if(tags.length>0){return tags[0].innerHTML;}}catch(err){console.log("XML Error:",err.message);}return null;}function formatBandwidth(bytesPerSec){const SIZE_KB=1024;const SIZE_MB=1024*1024;let bitsPerSec=bytesPerSec*8;if(bitsPerSec<SIZE_KB){return `${bitsPerSec}bit/s`;}else if(bitsPerSec<SIZE_MB){return `${(bitsPerSec/SIZE_KB).toFixed(2)}KBit/s`;}else{return `${(bitsPerSec/SIZE_MB).toFixed(2)}MBit/s`;}}function getModeDescription(mode){switch(mode){case "0":return "GSM";case "2":return "WCDMA";case "7":return "LTE";}return "Unknown mode";}function setParam(param,val){try{document.getElementById(param).innerHTML=val;}catch(param){};}function setVisible(id,visible){document.getElementById(id).style.display=visible?"block":"none";}function setMode(newMode){if(mode!==newMode){mode=newMode;console.log("Network mode set to", mode);setVisible("status_3g",false);setVisible("status_lte",false);if(mode==="WCDMA"){setVisible("status_3g",true);}else if(mode==="LTE"){setVisible("status_lte",true);}}}function currentBand(){$.ajax({type:"GET",async:true,url:'/api/device/signal',error:function(request,status,error){console.log("Error: Cannot get Signal data:",request.status,"\nmessage:",request.responseText,"\nerror:",error);},success:function(data){const doc=getXMLDocument(data);if(doc){const currentMode=getModeDescription(extractXML("mode",doc));let report=`Network mode : ${currentMode}`;setParam("mode",currentMode);setMode(currentMode);const rssi=extractXML("rssi",doc);report+=`\nRSSI : ${rssi}`;setParam("rssi",rssi);if(mode==="WCDMA"){const rscp=extractXML("rscp",doc);const ecio=extractXML("ecio",doc);report+=`\nRSCP : ${rsrq} EC/IO : ${ecio}`;setParam("rscp",rscp);setParam("ecio",ecio);}else if(mode==="LTE"){const rsrq=extractXML("rsrq",doc);const rsrp=extractXML("rsrp",doc);const sinr=extractXML("sinr",doc);report+=`\nRSRQ/RSRP/SINR : ${rsrq}/${rsrp}/${sinr}`;setParam("rsrp",rsrp);setParam("rsrq",rsrq);setParam("sinr",sinr);}console.log(report);}}});$.ajax({type:"GET",async:true,url:'/api/monitoring/traffic-statistics',error:function(request,status,error){console.log("Error: Traffic statistics responce fail:",request.status,"\nmessage:",request.responseText,"\nerror:",error);},success:function(data){const doc=getXMLDocument(data);if(doc){const dl=extractXML("CurrentDownloadRate",doc);const ul=extractXML("CurrentUploadRate",doc);const report=`Download : ${dl} Upload : ${ul}`;setParam("dl",formatBandwidth(dl));setParam("ul",formatBandwidth(ul));console.log(report);}}});}function statusHeader(){document.body.insertAdjacentHTML("afterbegin",'<style>#mode,#rssi,#rscp,#ecio,#rsrq,#rsrp,#sinr,#ul,#dl{color:#b00;font-weight:strong;}.f{float:left;border:1px solid #bbb;border-radius:5px;padding:10px;line-height:2em;margin:5px;}.f ul{margin:0;padding:0;}.f ul li{display:inline;margin-right:10px;}</style><div style="display:block;overflow:auto;"><div class="f" id="status_general"><ul><li>Network mode:<span id="mode">#</span></li><li>RSSI:<span id="rssi">#</span></li></ul></div><div class="f" id="status_3g"><ul><li>RSCP:<span id="rscp">#</span></li><li>EC/Io:<span id="ecio">#</span></li></ul></div><div class="f" id="status_lte"><ul><li>RSRQ:<span id="rsrq">#</span></li><li>RSRP:<span id="rsrp">#</span></li><li>SINR:<span id="sinr">#</span></li></ul></div><div class="f" id="bandwidth"><ul><li>Download:<span id="dl">#</span></li><li>Upload:<span id="ul">#</span></li></ul></div></div>');setInterval(currentBand,2000);}statusHeader();